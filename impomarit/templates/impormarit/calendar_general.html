{% extends 'base_old.html' %}
{% load static %}

{% block script %}
    <!-- DATATABLES -->
    <link rel="stylesheet" type="text/css" href="{% static 'datatables/datatables.min.css'  %}">
    <link rel="stylesheet" type="text/css" href="{% static 'datatables/buttons.dataTables.min.css'  %}">
    <!-- jQuery UI -->
    <link rel="stylesheet" type="text/css" href="{% static 'jquery-ui/jquery-ui-1.10.0.custom.css'  %}">
    <script src="{% static 'datatables/datatables.min.js' %}"></script>
    <script src="{% static 'datatables/dataTables.buttons.min.js' %}"></script>
    <script src="{% static 'js/jquery-ui.min.js' %}"></script>
    <script src="{% static 'grilla/js_controlador_sidemenu.js' %}"></script>
    <script type="text/javascript" src="{% static 'summernote/summernote-lite.js' %}"></script>
    <link rel="stylesheet" type="text/css" href="{% static 'summernote/summernote-lite.css'  %}">

    <!-- FullCalendar CSS -->
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/main.min.css" rel="stylesheet">
    <!-- FullCalendar JS -->
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/main.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/locales-all.min.js"></script>

{% block script_table %}
    <!-- Custom script for the calendar can be added here -->
{% endblock script_table %}
{% endblock script %}

{% block css %}
    <style>
        td.details-control {
            background: url('/static/images/mas.png') no-repeat center center;
            cursor: pointer;
        }
        tr.shown td.details-control {
            background: url('/static/images/menos.png') no-repeat center center;
        }
        .table {
            white-space: nowrap;
        }
        .derecha {
            text-align: right;
        }
        .centro {
            text-align: center;
        }
        .dataTables_filter { display: none; }
        {% block css_basetable %}
        {% endblock css_basetable %}
    </style>
{% endblock css %}

{% block contenido %}
    <div id="page-wrapper">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12">
                    <div class="panel-body">
                        <div class="row">
                            <div class="col-lg-12">
                                {% block table_datatable %}
                                <div id="calendar"></div> <!-- Aquí es donde se mostrará el calendario -->
                                {% endblock table_datatable %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
<!-- Modal donde se mostrará la información del evento -->
<div id="myModal" style="display:none;">
    <div id="modal-content"></div>
    <button id="close-modal-btn" class="btn btn-secondary">Cerrar</button>
</div>

{% block script_datatable %}
<script>
    document.addEventListener('DOMContentLoaded', function () {
        var calendarEl = document.getElementById('calendar');

        var calendar = new FullCalendar.Calendar(calendarEl, {
            initialView: 'dayGridMonth',
            events: '/importacion_maritima/eventos-calendario/',  // Ruta a la vista que devuelve los eventos
            locale: 'es',
            headerToolbar: {
                left: 'prev,next today',
                center: 'title',
                right: 'dayGridMonth,timeGridWeek,timeGridDay'
            },
            eventClick: function (info) {
                // Crear el contenido del modal con los datos del evento
                var modalContent = `
                    <p><strong>Transportista:</strong> ${info.event.extendedProps.transportista}</p>
                    <p><strong>Consignatario:</strong> ${info.event.extendedProps.consignatario}</p>
                    <p><strong>AWB:</strong> ${info.event.extendedProps.awb}</p>
                    <p><strong>HAWB:</strong> ${info.event.extendedProps.hawb}</p>
                    <p><strong>Status:</strong> ${info.event.extendedProps.status}</p>
                    <p><strong>Origen:</strong> ${info.event.extendedProps.origen}</p>
                    <p><strong>Destino:</strong> ${info.event.extendedProps.destino}</p>
                    <p><strong>Tipo:</strong> ${info.event.extendedProps.source_formatted}</p>
                    <p><strong>Posición:</strong> ${info.event.extendedProps.posicion}</p>
                `;

                // Mostrar el contenido en un modal o una sección del HTML
                // Aquí vamos a mostrarlo en un modal de jQuery UI, pero puedes adaptarlo a lo que necesites.
                $("#modal-content").html(modalContent);
                $("#myModal").dialog({
                    title: "Detalles del Evento",
                    width: 400,
                    modal: true
                });
            }
        });

        calendar.render();
        $("#close-modal-btn").click(function() {
            $("#myModal").dialog("close");
        });
    });
</script>


{% endblock script_datatable %}
{% endblock contenido %}
