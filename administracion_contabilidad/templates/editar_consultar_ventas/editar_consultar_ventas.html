{% extends 'base_table_v2.html' %}
{% load static %}
{% block contenido %}
<title>Consultar Ventas</title>

<style>
  .tabla-scroll {
    max-height: 300px;
    overflow-y: auto;
    display: block;
  }
  .oculto {
    display: none;
  }
</style>
<style>
  .tabla-scroll {
    max-height: 300px;
    overflow-y: auto;
    display: block;
  }

  .tabla-scroll table {
    border-collapse: separate;
    border-spacing: 0;
    width: 100%;
  }

  .tabla-scroll thead {
    position: sticky;
    top: 0;
    z-index: 2;
    background-color: #f8f9fa; /* Asegura fondo para que no se mezcle con el contenido */
  }

  .tabla-scroll th {
    background-color: #f8f9fa;
  }
</style>
<style>
  /* Reduce tama침o de fuente general */
  #consultaVentas input,
  #consultaVentas select,
  #consultaVentas label,
  #consultaVentas legend {
    font-size: 0.85rem;
  }

  #consultaVentas .form-control {
    height: calc(1.5em + 0.5rem + 2px);
    padding: 0.25rem 0.5rem;
  }

  #consultaVentas .form-check-input {
    transform: scale(0.85);
    margin-top: 0.2rem;
  }

  #consultaVentas .form-check-label {
    padding-left: 0.25rem;
  }

  #consultaVentas .d-grid {
    gap: 5px !important;
  }

  #consultaVentas fieldset {
    padding: 0.5rem;
  }

  #consultaVentas .btn {
    font-size: 0.85rem;
    padding: 4px 8px;
  }

  #consultaVentas .table {
    font-size: 0.85rem;
  }
</style>

<link rel="stylesheet" type="text/css" href="{% static 'css/administracion/administracion.css'  %}">

<div id="consultaVentas" class="border rounded p-3 bg-light" style="max-width: 80vw; overflow: hidden; font-size: 14px;">
<form method="get" id="consultaVentasForm" action="{% url 'editar_consultar_ventas' %}">

    {% csrf_token %}

    <div class="d-grid" style="grid-template-columns: 3fr 1fr; gap: 15px; align-items: start;">
      <!-- 游늷 Contenedor principal del formulario -->
      <div class="p-2">

        <!-- Omitir fechas, fechas desde y hasta -->
        <div class="d-grid mb-2" style="grid-template-columns: 1fr 2fr 2fr; gap: 10px; align-items: end;">
          <div class="form-check">
            {{ form.omitir_fechas }}
            <label class="form-check-label" for="{{ form.omitir_fechas.id_for_label }}">
              {{ form.omitir_fechas.label }}
            </label>
          </div>
          <div>
            {{ form.fecha_desde.label_tag }}
            {{ form.fecha_desde }}
          </div>
          <div>
            {{ form.fecha_hasta.label_tag }}
            {{ form.fecha_hasta }}
          </div>
        </div>

        <!-- Moneda y Monto -->
        <div class="d-grid mb-2" style="grid-template-columns: 1fr 1fr; gap: 10px;">
          <div>
            {{ form.monedas.label_tag }}
            {{ form.monedas }}
          </div>
          <div>
            {{ form.monto.label_tag }}
            {{ form.monto }}
          </div>
        </div>

        <!-- Proveedor y Documento -->
        <div class="d-grid mb-2" style="grid-template-columns: 1fr 1fr; gap: 10px;">
          <div>
            {{ form.cliente.label_tag }}
            {{ form.cliente }}
            {{ form.cliente_codigo }}
          </div>
          <div>
            {{ form.documento.label_tag }}
            {{ form.documento }}
          </div>
        </div>

        <!-- Posici칩n -->
        <div class="mb-2">
          {{ form.posicion.label_tag }}
          {{ form.posicion }}
        </div>

          <!-- 游늷 Tabla de resultados -->
  <div class="tabla-scroll mt-4 border rounded">
    <table class="table table-sm mb-0" id="tabla_consultar_ventas">
      <thead class="thead-light">
        <tr>
          <th>Documento</th>
          <th>Fecha</th>
          <th>Cliente</th>
          <th>Importe</th>
          <th class="oculto">Autogenerado</th>
        </tr>
      </thead>
      <tbody>
        {% for item in resultados %}
          <tr>
            <td>{{ item.documento }}</td>
            <td>{{ item.fecha }}</td>
            <td>{{ item.cliente }}</td>
            <td>{{ item.importe }}</td>
            <td class="oculto">{{ item.autogenerado }}</td>
            <td class="oculto">{{ item.numero }}</td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="5" class="text-center">No hay resultados.</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
                <div id="spinnerCarga" class="text-center my-3" style="display: none;">
  <div class="spinner-border text-primary" role="status">
    <span class="sr-only">Cargando...</span>
  </div>
  <div>Cargando datos...</div>
</div>
      </div>

      <!-- 游늷 Secci칩n lateral con radios y bot칩n -->
      <div class="border p-3 rounded bg-light w-30">
        <fieldset class="border p-2 mb-3">
          <legend class="w-auto px-2">Tipo</legend>
          {% for radio in form.tipo %}
            <div class="form-check">
              {{ radio.tag }}
              <label class="form-check-label" for="{{ radio.id_for_label }}">
                {{ radio.choice_label }}
              </label>
            </div>
          {% endfor %}
        </fieldset>

        <fieldset class="border p-2 mb-3">
          <legend class="w-auto px-2">Estado</legend>
          {% for radio in form.estado %}
            <div class="form-check">
              {{ radio.tag }}
              <label class="form-check-label" for="{{ radio.id_for_label }}">
                {{ radio.choice_label }}
              </label>
            </div>
          {% endfor %}
        </fieldset>

        <button type="submit" class="btn btn-primary btn-sm w-100">Buscar</button>
      </div>
    </div>
  </form>


</div>

{% include 'editar_consultar_ventas/editar_consultar_ventas_detalle.html' %}
{% include 'editar_consultar_ventas/editar_consultar_ventas_detalle_pago.html' %}
{% include 'embarque.html' %}
{% include 'editar_consultar_ventas/editar_consultar_ventas_detalle_conocimiento.html' %}

<script src="{% static 'grilla/editar_consultar_ventas.js' %}"></script>
    <script>
       var csrf_token = '{{ csrf_token }}';
    </script>
{% endblock contenido %}
